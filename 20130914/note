大家好，我叫邵天宇，今天来到这里很荣幸，非常感谢谢大邀请我参加这个活动，我给大家分享的是Go在微博数据分析中的一些简单应用。
这次准备的时间比较仓促，所以多有不足请多多包涵，我这边项目刚起步，所以这里也只能做些简单的分享。

首先我们简单说一下Go，相信来到这里的人都是或多或少已经接触过，我也不做赘述了。
Go语言是谷歌2009发布的第二款开源编程语言，出生豪门，刚出生就含着金钥匙，父母都是大牛，所以可以说Go从出生就光芒闪耀，相信自身实力也不俗。

下面说说Go最吸引我的几点：
Go天生就是为了解决问题而出现的，可以在不损失应用程序性能的情况下降低代码的复杂性，提高开发效率。
Go专门针对多处理器系统应用程序的编程进行了优化，虽然目前还不够完美，但是相信大家都看得到Go每个版本的进步，使用Go编译的程序可以媲美C或C++代码的速度，而且更加安全、支持协程。
Go跟C和C++一样是编译型语言，相比后者编译速度非常快。
Go提供的标准库相比Java、Python来说可以说是少得可怜，但是绝对算得上少而精，同时Go提供了CGO这个强大的工具可以让我们通过嵌入C代码来扩展程序。
Go是专为构建服务器软件所设计，可以被用于网络服务器、存储系统和数据库中等。随着时间的推移，相信Go会被应用在更多的领域。
Go的代码非常简洁、优秀，提供我们非常好的学习机会，写代码的时候经常会有意无意的去看看底层的代码实现。


好了，接下来我们说说新浪微博：
2013年上半年，新浪微博注册用户达到5.36亿，微博成为中国网民上网的主要活动之一。
微博是一个基于用户关系信息分享、传播以及获取的平台，他的最大的特点就是：发布信息快速，信息传播的速度快。
微博的出现，让国内网民拥有了一个可以独立自主且相对自由的发声渠道，许多一手新闻甚至猛料均来自草根。在国内监管较为严格的媒体环境之下，微博这个属性显得弥足珍贵，不论富贵贫穷的公开平台。不过随着监管越来越严，现在说不得转发过了五百条就给请去喝咖啡了。。
在过去三年时间里，我一直做着微博数据方面的一些开发工作，微博既然有这么大的数据量，这么多的用户数据，那么我们能拿这些数据来做什么呢？
对企业来说，可以通过这些数据发现你的客户以及潜在客户，调研用户行为，品牌口碑等等。
对于个人用户来说，可以通过这些数据发现自己感兴趣的人和事，扩展自己的交际圈等等。


既然这些数据这么有用，我们靠人看肯定是不行的，该轮到Go出厂了。
我到新公司的任务就是把公司的微博数据以及其数据的分析业务给折腾起来。
这里说个插曲，我去面试的时候就跟老板说了，我要用Go语言来做这块，老板很愉快的答应了，我也就很开心就留下了。。
然后就有了现在这个项目 Walle·E

Walle·E 主要由四个部分组成
- API代理
- 数据抓取
- 数据分发层
- 全文索引
- 数据分析

API代理是整个系统的基础，通过模拟用户登录实现账号自动授权以及Token的自动延期，保证系统的API调用不间断，数据抓取层在调用API时就不需要考虑Token的问题，直接调用即可。
爬虫获得的所有数据，会首先压入队列，通过数据预处理层处理后，再分发到各模块处理各自的逻辑。
队列这块我主要是采用了bitly的nsq来做，nsq的性能非常高，我的Mac mini上可以达到异步写入可以80mb/s，读取速度也有30mb/s，内部机制保证每条消息至少可以送达一次，节点容灾。我们可以通过mem-queue-size来限定队列的大小，如果消息过多就会持久化到硬盘，设置成0的话所有的消息都会保存，我们不用担心消息会丢失，nsq内部机制保证在程序关闭时持久化队列中的数据到硬盘，重启后就会恢复。
消息是发送到topic，topic广播给channel，多个worker订阅到channel上，worker收到信息去处理相应的逻辑。
nsqlookupd 是nsq的一个路由程序，如果是分布式的话会用到，我这里是单机所有就没有做。
整体的架构大概就是这样，比较简单，扩展性还比较好。

标签传播算法是一种基于图的半监督学习方法，其基本思路是用已标记节点 的标签信息去预测未标记节点的标签信息。
利用样本间的关系建立关系完全图模型，在完全图中，节点包括已标注和未标注数据，其边表示两个节点的相似度，节点的标签按相似度传递给其他节点。标签数据就像是一个源头，可以对无标签数据进行标注，节点的相似度越大，标签越容易传播。
哪些可以作为用户的标签呢，主要是用户发布和转发的微博中分词后标记出用户的兴趣词，用户的自标签，我关注的人，以及关注我的人来作为图的边。
用这些标签可以给图中的每个节点赋予独一无二的标签，再经过多轮迭代，通过社交关系（图的边）将标签向其他节点传播，某个节点再根据与其有联系的其他节点的标签来决定自己此轮应该赋予何种标签（相邻节点出现最多的标签，如果都一样多那就随机选一个），如此进行多轮迭代后趋于平衡

